<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#121212">
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="icon" sizes="192x192" href="./icons/icon-192.png">
  <title>Confluence Calculator</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>Confluence Calculator</h1>
        <p class="subtitle">Set & Forget â€¢ Mobile</p>
      </div>
    </div>
    <div class="header-actions">
      <label class="edit-toggle"><input type="checkbox" id="editMode"> Edit Mode</label>
      <select id="textSize" title="Text size">
        <option value="normal">Text: Normal</option>
        <option value="small">Text: Small</option>
        <option value="large">Text: Large</option>
      </select>
      <button id="btnDark" title="Toggle theme">ðŸŒ“</button>
    </div>
  </header>

  <main>
    <section class="card">
      <div class="markets">
        <label>Market</label>
        <div class="markets-row">
          <select id="marketSelect"></select>
          <button id="btnAddMarket" class="secondary">+ Add</button>
          <button id="btnRenameMarket" class="secondary">Rename</button>
          <button id="btnDeleteMarket" class="danger">Delete</button>
        </div>
        <p class="muted small">Each market has its own saved checklist and settings.</p>
      </div>
    </section>

    <section class="card">
      <div class="row">
        <label>Pair</label>
        <input id="pair" placeholder="EUR/USD">
      </div>
      <div class="row two">
        <div class="col">
          <label>Bias</label>
          <select id="bias">
            <option value="">â€”</option>
            <option>Buy</option>
            <option>Sell</option>
          </select>
        </div>
        <div class="col">
          <label>Account Type</label>
          <select id="acctType">
            <option>Live</option>
            <option>Funded</option>
            <option>Challenge</option>
          </select>
        </div>
      </div>
      <div class="row two">
        <div class="col">
          <label>Trade Type</label>
          <select id="tradeType">
            <option value="swing">Swing / Inter-Day</option>
            <option value="day">Day Trade</option>
            <option value="scalp">Scalp</option>
          </select>
        </div>
        <div class="col">
          <label>Month</label>
          <select id="month"></select>
        </div>
      </div>
      <div class="row two">
        <div class="col">
          <label>Planned Risk %</label>
          <input id="riskPct" type="number" inputmode="decimal" min="0" step="0.1" placeholder="2">
        </div>
        <div class="col">
          <label>Min RR</label>
          <input id="rrMin" type="number" inputmode="decimal" min="1" step="0.1" value="2.5">
        </div>
      </div>
      <details>
        <summary>Broker & chart links (optional)</summary>
        <div class="row">
          <label>Broker URL</label>
          <input id="brokerUrl" placeholder="https://">
        </div>
        <div class="row">
          <label>TradingView URL</label>
          <input id="tvUrl" placeholder="https://www.tradingview.com/">
        </div>
      </details>
    </section>

    <section class="card">
      <h2>Timeframes In Sync</h2>
      <p class="muted">Tick the frames that agree with your bias.</p>
      <div class="grid3">
        <label class="check"><input type="checkbox" id="syncW"><span>Weekly</span><span class="badge">+10%</span></label>
        <label class="check"><input type="checkbox" id="syncD"><span>Daily</span><span class="badge">+10%</span></label>
        <label class="check"><input type="checkbox" id="syncH4"><span>4H</span><span class="badge">+10%</span></label>
      </div>
    </section>

    <section class="card" id="sections"></section>

    <section class="card totals">
      <div class="row">
        <div>
          <div class="kpi">
            <span id="score">0%</span>
            <small>Total confluence</small>
          </div>
        </div>
        <div>
          <div class="kpi">
            <span id="grade">â€”</span>
            <small>Grade</small>
          </div>
        </div>
        <div>
          <div class="kpi">
            <span id="riskAdvice">â€”</span>
            <small>Suggested risk</small>
          </div>
        </div>
      </div>
      <div class="row two">
        <label class="check"><input type="checkbox" id="reqShift"><span>Shift of Structure (required)</span></label>
        <label class="check"><input type="checkbox" id="reqEngulf"><span>Engulfing (required)</span></label>
      </div>
      <div class="row two">
        <div class="col">
          <label>Planned RR</label>
          <input id="rrPlanned" type="number" inputmode="decimal" min="1" step="0.1" placeholder="2.5">
        </div>
        <div class="col">
          <label>Stop buffer (pips)</label>
          <input id="slBuffer" type="number" inputmode="decimal" min="0" step="0.1" value="6">
        </div>
      </div>

      <div class="cta-row">
        <button id="btnShare" class="secondary">Share/Copy Ticket</button>
        <button id="btnSaveImage" class="secondary">Save Image</button>
        <button id="btnExportJson" class="secondary">Export JSON</button>
        <button id="btnTV" class="secondary">Open Charts</button>
        <button id="btnBroker" class="secondary">Open Broker</button>
        <button id="btnEnter" class="primary">Enter Trade</button>
      </div>
      <p id="blocker" class="blocker"></p>
    </section>

    <section class="card">
      <details>
        <summary>Weights & Settings</summary>
        <p class="muted">Tweak confluence weights; your changes are saved per market on this device.</p>
        <div id="weightsEditor"></div>
        <button id="btnReset" class="danger">Reset to defaults</button>
      </details>
    </section>

    <footer class="muted">
      <p>Made for your Set & Forget strategy. Offline capable. Add to Home Screen for an app-like feel.</p>
    </footer>
  </main>

  <script src="./app.js"></script>
</body>
</html>
